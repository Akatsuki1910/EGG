構造化DB（RDB）サービスの詳細を確認しましょう
最初はCloud SQLです
SQLにGoogle Cloudサービスを使う理由は何でしょう
VMにSQLサーバーイメージをインストールする方法を取らないのはなぜでしょう
これはまさに、独自のDBソリューションを構築すべきか、マネージドサービスを利用すべきかの問題です
マネージドサービスの利点を活用するために、Google Cloud内のCloud SQLを選ぶ理由を確認しましょう
Cloud SQLはフルマネージドサービスで、MySQL、PostgreSQL、またはMicrosoft SQL Server DBで構成できます
パッチと更新は自動的に適用されます
しかしMySQLユーザーについては、DB付属のネイティブ認証ツールで管理する必要があります
Cloud SQLで使用できるクライアントは、Cloud Shell、App Engine、Workspaceスクリプトなど多岐にわたります
また、SQL WorkbenchやToadなど使い慣れた他のアプリとツールや、標準MySQLドライバを使用する外部アプリもサポートされます
Cloud SQLは高パフォーマンスかつ、スケーラブルで、最大30TBのストレージ容量、40,000 IOPS、１インスタンスにつき416GBのRAMを提供します
64コアへのスケールアップや、リードレプリカによるスケールアウトも簡単です
現在使用できるCloud SQLの構成は、MySQL 5.6、5.7、8.0、PostgreSQL 9.6、10、11、12、SQL Server 2017のうちWeb、Express Standard、Enterpriseのいずれかです
動画の収録時点です
Cloud SQLが提供する他のサービスに注目しましょう
リージョンインスタンス内でのHA構成は、プライマリインスタンスとスタンバイインスタンスからなります
各ゾーンの永続ディスクへの同期レプリケーションにより、プライマリへの書き込みのすべてが両方のゾーンのディスクに複製されてから、トランザクションのcommitが報告されます
インスタンスやゾーンで障害が発生した場合、永続ディスクがスタンバイにアタッチされてプライマリになります
ユーザーは新しいプライマリに再転送されます
このプロセスはフェイルオーバーと呼ばれます
Cloud SQLはポイントインタイムリカバリ対応の自動/オンデマンドのバックアップも提供します
mysqldumpを使用したDBのインポートとエクスポートや、CSVファイルのインポートとエクスポートが可能です
スケールアップもできますが、マシンの再起動が必要です
スケールアウトにはリードレプリカを使います
ただし、水平方向のスケーラビリティが必要な場合は、別途取り上げるCloud Spannerの使用を検討してください
Cloud SQLインスタンスとの接続方法は、セキュリティ、パフォーマンス、自動化に影響します
接続するアプリがCloud SQLインスタンスと同じGoogle Cloudプロジェクトでホストされていて、同じリージョン内に配置されている場合、プライベートIP接続を選択すると、パフォーマンスとセキュリティを大きく高めることができます
トラフィックが公共のインターネットに公開されることはありません
同一リージョンのVMからCloud SQLのプライベートIPアドレスへの接続は、パフォーマンスの面で推奨されますが、必須ではありません
アプリが別のリージョンやプロジェクト内にある場合、またはCloud SQLインスタンスにGoogle Cloud外部から接続する場合は、３つの選択肢があります
この場合は、Cloud SQL Proxyの使用を推奨します
認証、暗号化、鍵のローテーションが自動化されるためです
SSL接続を手動で制御する必要がある場合は、証明書を自分で生成し、定期的にローテーションできます
その必要がなければ、特定のIPアドレスに対し、外部IPアドレスでのSQLサーバーへの接続を認証することで、暗号化なしの接続を使用できます
これらの選択肢は次のラボで確認しますが、プライベートIPの詳細を学ぶには動画のリンクセクションをご覧ください
まとめとして、このディシジョンツリーで、完全なリレーショナル機能を備えた適切なデータストレージサービスを判断しましょう
30TBを超える保存容量か、DBへの4,000を超える同時接続が必要な場合、またはアプリの設計でスケーリング、可用性、ロケーション管理に対応して、グローバルにスケールアップする必要がある場合は、このモジュールで後から説明するCloud Spannerの使用を検討してください
これらの制約に懸念がない場合は、特定のOSに関する要件があるかどうか、カスタムのDB構成、特殊なバックアップの要件がないかを確認します
こうした要件がある場合は、GCEを使って独自のDBをVM上でホストすることを検討してください
そうでなければ、RDBのフルマネージドサービスとして、Cloud SQLを使用することを強く推奨します
既存のMySQLソリューションの使用や、再実装ではなく、Cloud SQLを使うことに決めたら、リンクセクションでMySQLからCloud SQLへの移行ソリューションをご確認ください

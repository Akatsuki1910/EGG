GCPでカスタムロールを作成する方法を説明します
ここでの目標は、Compute Engine VMを起動、停止できても、再構成はできないインスタンス、オペレーターのロールを作成することです
ではGCP Consoleで、[ナビゲーションメニュー]から[IAMと管理]に移動します
次に[ロール]に移動します
ここには利用できるすべてのロールが表示されます
いずれかのロールを選択してそれを基にロールを作成し、権限を削除または追加すると、ここでロールに割り当てられている権限を確認できます
あるいは、ロールを最初から作成することもできます
[ロールを作成]をクリックします
ロールに名前を付けます
ここではInstance Operatorとします
ロールにはIDがありますが一意である必要があり変更はできません
リリース段階として、アルファ版、ベータ版、一般提供、無効のいずれかを選択できます
基本的には単なるリリース段階なので、必ず小規模なアルファ版でテストしてから、その後ほかのユーザーに展開すれば、ユーザーはこの機能を活用できます
では[権限を追加]をクリックします
まだ権限が割り当てられていないため、最初から作成する場合があります
2,000個以上のさまざまな権限があるので、少しフィルタしましょう
Computeインスタンスに関する権限を探したいので、“compute.instances”と入力します
Enterキーを押すと44個まで絞り込めました
この中からいくつか選択します
異なるインスタンスを取得したいので、getを選択します
全インスタンスのリストを表示するlistと、リセットするresetも選択します
resumeも選択します
これはインスタンスが停止したときや、スリープ、スタンバイモードのときに使用します
start、stop、suspendも選択します
[追加]をクリックすると割り当てた権限である、get、list、reset、resume、start、stop、suspendが表示されます
ここで[作成]をクリックします
作成したロールをクリックして確認しましょう
ID、リリース段階、権限が設定されていることがわかります
このようにGCPでは、簡単にカスタムロールを作成できます
別の方法としてインスタンス管理者ロールを基に作成を開始し、そのロールに必要ない権限を削除することもできます
カスタムロールはGoogleによって管理されないため、新しい権限、機能、サービスがGCPに追加されても、こうしたカスタムロールが自動的に更新されることはありません

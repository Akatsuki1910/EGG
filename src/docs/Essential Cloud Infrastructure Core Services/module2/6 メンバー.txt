メンバーについてもう少し説明しましょう
メンバーはリソースに対してアクションを起こす主体を定義します
メンバーには５種類あります
Googleアカウント、サービスアカウント、Googleグループ、Google Workspaceドメイン、Cloud Identityドメインです
Googleアカウントは開発者、管理者、Google Cloudとやり取りするその他のユーザーを表します
Googleアカウントには、gmail.comやその他のドメインなど、任意のメールアドレスを関連付けられます
Gmailでメールを受信しなくても、Googleアカウントの登録ページから新規ユーザーとして登録できます
サービスアカウントは、個々のエンドユーザーではなく、アプリに属するアカウントです
Google Cloud上でホストされているコードを実行する場合は、そのコードの実行で使用されるアカウントを指定します
サービスアカウントは必要な数だけ作成して、アプリのさまざまな論理コンポーネントを表すことができます
Googleグループは Googleアカウントとサービスアカウントの名前付きコレクションです
どのグループにも関連付けられた一意のメールアドレスがあります
Googleグループを使用すると、複数のユーザーに対してアクセスポリシーを簡単に適用できます
個々のユーザーやサービスアカウントごとに、アクセス制御を付与、変更しなくても、グループ全体に対してアクセス制御を一度に付与および変更できます
Workspaceドメインは、組織のWorkspaceアカウントで作成されたすべてのGoogleアカウントの仮想グループを表します
Workspaceドメインはexample.comなどの組織のインターネットドメイン名を表し、Workspaceドメインにユーザーを追加すると、この仮想グループ内にusername@example.comのようにユーザーの新しいGoogleアカウントが作成されます
Workspaceをご利用でないGoogle Cloudのお客様は、Cloud Identityを介して同じ機能を利用できます
Cloud Identityでは、Google管理コンソールを使用してユーザーとグループを管理できます
料金は発生しませんがGmail、ドキュメント、ドライブ、カレンダーなど、Workspaceのその他のサービスは利用できません
IAMを使用したユーザーやグループの作成、管理はできないのでご注意ください
代わりにCloud IdentityまたはWorkspaceでユーザーを作成、管理できます
ポリシーは、バインディングのリストで構成されます
バインディングはメンバーのリストをロールにバインドするものです
この場合のメンバーとは、ユーザーアカウント、Googleグループ、Google Domains、サービスアカウントです
ロールとはIAMによって定義された権限の名前付きリストです
IAMリソースの階層を見てみましょう
ポリシーとはリソースに関連付けられたアクセスステートメントのコレクションです
各ポリシーには、ロールとロールメンバーのセットが含まれ、リソースは親からポリシーを継承します
リソースポリシーは、親とリソースを組み合わせたものと考えることができます
制限の緩い親ポリシーが、制限の厳しいリソースポリシーより常に優先されます
IAMポリシーの階層は常に、Google Cloudリソースの階層と同じパスをたどります
つまりリソースの階層を変更すると、ポリシーの階層も変更されます
たとえばプロジェクトを別の組織に移動すると、プロジェクトのIAMポリシーが更新され、新しい組織のIAMポリシーから継承するようになります
また親レベルで付与されたアクセス権を子ポリシーで制限することはできません
たとえばDept Xに編集者ロールを付与した場合、bookshelfプロジェクトレベルで閲覧者ロールを付与しても、そのプロジェクトは編集者ロールを持ちます
したがって最小権限の原則を遵守するのがベストプラクティスです
この原則はID、ロール、リソースに当てはまります
リスクを抑えるためには、タスクにとって必要最小限のスコープを常に選択してください
ロールの推奨事項を提供するRecommenderを使用して、過剰な権限を特定して原則から削除し、リソースのセキュリティ設定を向上させることもできます
ロールの各推奨事項では、原則に過剰な権限を付与しているロールがあれば削除や変更が提案されます
大規模な環境の場合、これらの推奨事項を活用して、実際に必要な権限のみが原則に含まれるようにすることで、最小権限の原則を適用できます
Recommenderはポリシーの分析情報を使用して、過剰な権限を特定します
ポリシーの分析情報は、プロジェクト、フォルダ、組織での権限使用に関するMLベースの分析結果です
IAM Conditionsを使用するとGoogle Cloudリソースに対して、条件付きの属性ベースのアクセス制御を定義して適用できます
IAM Conditionsでは設定した条件を満たす場合にのみ、IDやメンバーにリソースへのアクセス権を付与できます
たとえば本番環境に問題が発生した場合に、ユーザーの一時的なアクセスを構成したり、社内でリクエストした従業員だけが、リソースにアクセスできるよう制限したりできます
ConditionsはリソースのIAMポリシーのロールのバインディングで指定します
条件が存在する場合、条件がtrueと評価されたときにのみ、アクセスリクエストが許可されます
各条件式は一連の論理ステートメントとして定義され、１つ以上の属性を指定してチェックできます
組織ポリシーは制限の構成で、その組織に制限を含む制約を構成することによって定義されます
組織ポリシーは組織ノードとそのノード内のすべてのフォルダやプロジェクトに適用できます
対象となるリソース階層の子孫は、親に適用された組織ポリシーを継承します
これらのポリシーの例外を作成できますが、組織ポリシー管理者のロールが必要です
すでに別の企業ディレクトリがある場合はどうでしょう
ユーザーやグループを、Google Cloudに取り込むにはどうすればよいでしょう
Google Cloud Directory Syncでは管理者はすでに使用しているものと同じ、ユーザー名とパスワードを使って、Google Cloudにログインしてリソースを管理できます
このツールを使用すると既存のActive DirectoryまたはLDAPシステムのユーザーとグループを、Cloud Identityドメインのユーザーとグループと同期できます
同期は一方向で行われます
つまりActive DirectoryまたはLDAPマップ内の情報は変更されません
Google Cloud Directory Syncは同期ルールの設定後に、スケジュール設定された同期を自動的に実行します
Google Cloudではシングルサインオン認証も提供しています
独自のIDシステムがある場合は、SSOを構成して独自のシステムやプロセスを使い続けられます
認証が必要な場合はGoogleによって、そのシステムにリダイレクトされます
ユーザーがシステムで認証されている場合は、Google Cloudへのアクセスが許可されますが、そうでない場合はログインを求められます
これを使用してGoogle Cloudへのアクセス権を取り消すこともできます
既存の認証システムがSAML2をサポートしている場合は、スライドに示すように、３つのリンクと証明書だけで簡単にSSOを構成できます
サポートしていない場合は、ADFS、Ping、Oktaなどのサードパーティ製ソリューションを使用できます
既存のID管理システムを使用する方法について、詳しくはこの動画のリンクセクションをご覧ください
またGmailを利用しなくても、Googleアカウントは作成、使用できます
詳しくはこの動画のリンクセクションをご覧ください

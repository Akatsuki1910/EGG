この動画ではGoogle Cloudの統合型ロギングツールを紹介します
Cloud Loggingではログエントリやイベントの、収集、格納、検索、分析、モニタリング、警告を行えます
App Engine、Cloud Run、ロギング用Compute Engine VM、GKEなどの、Google Cloudプロダクトには自動ロギング機能が統合されています
多くのログアナリストがまず使用するのが、Logs Explorerです
エントリを複数の出力先にエクスポートして、比較分析や詳細分析を行うことも可能です
Pub/Subメッセージは、ほぼリアルタイムで分析でき、分析にはカスタムコードやDataflowなどのストリーム処理を使用できます
BigQueryを使えばロギングデータをSQLクエリで調査できます
Cloud Storageにアーカイブしたログファイルは、複数のツールと手法で分析できます
ログデータはファイルとして、Cloud Storageに、またはPub/SubメッセージとしてBigQueryテーブルにエクスポートできます
ログベースの指標を作成して、Cloud Monitoringダッシュボードやアラート、SLOに統合できます
Cloud Loggingのログ保持期間はログの種類で異なります
データアクセスログは既定で30日間保持されますが、最長3,650日まで設定を変更できます
管理ログは既定で400日間保持されます
Cloud StorageやBigQueryへのエクスポートも保持期間の延長手段です
Cloud Loggingで確認できるログは、どのGoogle Cloudリソースを使用しているかで異なります
ログの４大カテゴリが、監査ログ、エージェントログ、ネットワークログ、サービスログです
Cloud Audit Logsは“いつ、どこで、誰が、何を”の解析に役立ちます
Admin Activityは構成の変更を追跡します
Data Accessではリソースの構成やメタデータを読み取る呼び出し、ユーザーによるリソースデータの作成、変更、読み取りの呼び出しを追跡します
System Eventは人間が介入しないGoogle Cloudの管理機能で、リソースの構成を変更します
Access Transparencyでは、Googleの担当者がお客様のコンテンツにアクセスした際の操作ログを確認できます
Agent LogsはGoogleがカスタマイズしたFluentdエージェントを使います
エージェントをAWSか、Google Cloud VMにインストールして、インスタンスからログデータを取り込めます
たとえば Compute EngineやマネージドVM、コンテナ、AWS EC2インスタンスから取り込めます
Network Logsは運用向けの詳細なネットワークセキュリティテレメトリを提供します
VPC FlowはVPCネットワークフローのサンプルのログを取ります
ネットワーク監視やフォレンジック、リアルタイムセキュリティ分析や費用最適化のために利用できます
Firewall Rules Loggingでは、ファイアウォールルールの効果を監査、検証、分析できます
NAT Gateway LogsはNATネットワークの接続とエラーに関する情報を収集します
Service Logsでは、コードをデプロイする開発者が作成したログにアクセスできます
たとえばNode.jsでコンテナを構築して、Cloud Runにデプロイすると、標準出力や標準エラーへのロギングが自動的にCloud Loggingに送られ、簡単に一元表示できます

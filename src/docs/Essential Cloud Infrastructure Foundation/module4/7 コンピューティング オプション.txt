ラボを終えたところで、GCPで使用可能なコンピューティングオプションをCPUとメモリに注目して詳しく見ていきましょう
VMを作成して構成する方法は３つあります
前のラボで行ったように、GCP Consoleを使用するか、Cloud Shellコマンドライン、またはRESTful APIを使用します
非常に複雑な構成を自動化して処理する場合は、対象の環境に必要なさまざまなオプションをすべて定義し、RESTful APIを使ってプログラムで構成することをおすすめします
コマンドラインまたはRESTful APIを使用する場合は、デモで確認したように先にGCP Consoleでインスタンスを構成してから、Compute Engineに対して同等のRESTリクエストを送信するか、コマンドラインを使用することをおすすめします
こうすることで入力ミスがなくなり、利用可能なCPUとメモリのオプションがすべてプルダウンリストに表示されます
CPUとメモリのオプションに関して、現在利用可能なマシンタイプを見てみましょう
マシンタイプとは、システムメモリサイズやvCPU数、永続ディスクの最大容量など、VMインスタンスで利用できる一連の仮想ハードウェアリソースを指定するものです
GCPに用意されているマシンタイプは２つのカテゴリに分けられます
一つは事前定義されたマシンタイプで、リソースのコレクションが固定されています
Compute Engineによって管理され、複数の異なるクラスで使用できます
クラスごとにvCPUあたりのメモリ（GB）の比率が事前定義されています
標準、ハイメモリ、ハイCPU、メモリ最適化、コンピューティング最適化、共有コアマシンタイプがあります
もう一つはカスタムマシンタイプです
インスタンスのvCPUの数とメモリ容量を指定できます
それぞれのマシンタイプを見ていきますが、マシンタイプと利用可能なオプションは変更される場合があります
標準マシンタイプは、CPUとメモリのニーズのバランスが取れているタスクに適しています
標準マシンタイプではvCPUごとに3.75GBのメモリが割り当てられます
vCPUの構成は、この表に示すようにvCPU１個から96個までさまざまです
これらの各マシンは合計サイズが64TBまでの最大128個の永続ディスクをサポートします
これはハイメモリ、ハイCPU、メモリ最適化、コンピューティング最適化マシンタイプでも同様です
ハイメモリマシンタイプは、vCPU数に対して比較的多くのメモリを必要とするタスクに適しています
このマシンタイプではvCPUごとに6.5GBのシステムメモリが割り当てられます
標準マシンタイプと同じく、vCPUの構成はこの表に示すように２個から96個までさまざまです
ハイCPUマシンタイプは、メモリに対して比較的多くのvCPUを必要とするタスクに適しています
ハイCPUマシンタイプではvCPUごとに0.9GBのメモリが割り当てられます
メモリ最適化マシンタイプは、ハイメモリマシンタイプよりもメモリ対vCPU比が高いメモリを集中的に使用する必要があるタスクに適しています
このマシンタイプはSAP、HANAやビジネスウェアハウジングのワークロード、ゲノム解析、SQL分析サービスなど、インメモリデータベースやインメモリアナリティクスに最適です
メモリ最適化マシンタイプではvCPUごとに14GBを超えるメモリが割り当てられます
これらのマシンの構成は表に示すように、４種類です
現時点でローカルSSDをサポートしているのはn1-megamem-96のみです
コンピューティング最適化マシンタイプは、演算中心のワークロードに最適です
このタイプはCompute Engineでコアあたりのパフォーマンスが最も高くなります
最新のIntelスケーラブルプロセッサであるCascade Lakeを搭載したC2マシンタイプでは、全コアターボ時に最大3.8Ghzが維持されて、基盤となるサーバープラットフォームのアーキテクチャで、完全な透明性が確保され、高度なパフォーマンスチューニングが実現します
C2マシンタイプはN1ハイCPUマシンタイプよりも演算能力が大幅に高く、新しいプラットフォームで動作します
通常は演算中心のワークロードでより安定した動作が期待できます
共有コアマシンタイプには１個のvCPUが割り当てられており、インスタンスを実行しているホストCPU上の単一のハードウェアハイパースレッドで、一定時間実行できます
リソース使用量がそれほど多くない小規模のアプリを実行する場合、共有コアインスタンスは他よりも費用対効果に優れていることがあります
共有コアマシンタイプの選択肢は、f1-microとg1-smallの２つのみです
f1-microマシンタイプはインスタンスで追加の物理CPUを短時間だけ使用できるバースト機能を提供します
バーストはインスタンスで元の割り当てよりも多くの物理CPUが必要になった場合に自動的に発生します
需要が急増すると、その間、インスタンスは利用可能な物理CPUを見つけて突発的に使用します
バーストは永続的に続くものではなく、周期的にのみ使用可能です
これらのマシンタイプの最新情報については、この動画のリンクセクションをご覧ください
事前定義されたマシンタイプがニーズに合わない場合は、インスタンスで使用するvCPU数やメモリ量を個別に指定できます
カスタムマシンタイプは次のようなシナリオに適しています
事前定義された使用可能なマシンタイプがワークロードに適さない場合や、ワークロードでより多くの演算能力やメモリが必要だが、事前定義されたマシンタイプのうち次に大きいタイプで提供されるアップグレードのすべては必要でない場合です
同等の事前定義されたマシンタイプと比較すると、カスタムマシンタイプのほうが費用は若干高くなります
選択できるメモリ量やvCPU数にも制限があります
作成できるのはvCPUの数が１個または偶数のマシンタイプのみです
デフォルトでvCPUあたりのメモリは、0.9GB以上6.5GB以下に制限されています
インスタンスの合計メモリは256MBの倍数にする必要があります
デフォルトではカスタムマシンのメモリはvCPUあたり最大6.5GBですが、これではワークロードに対してメモリが足りないことがあります
その場合は追加料金をご負担いただければ、vCPUあたり6.5GBを超えるメモリを利用することも可能です
これは拡張メモリと呼ばれます
詳しくは、この動画のリンクセクションをご覧ください
リージョンとゾーンを選択する際にまず検討すべきことは、リソースを実行する地理的ロケーションです
この地図は現行および追加予定のGCPリージョンと、ゾーン数を示しています
利用可能なリージョンとゾーンの最新情報については、動画にリンクされているドキュメントをご覧ください
各ゾーンではIvy Bridge、Sandy Bridge、Haswell、Broadwell Skylakeプラットフォームの組み合わせがサポートされます
インスタンスを作成すると、そのゾーンでサポートされるデフォルトのプロセッサを使用します
たとえばus-central1-aゾーンで作成した場合、そのインスタンスはSandy Bridgeプロセッサを使用します

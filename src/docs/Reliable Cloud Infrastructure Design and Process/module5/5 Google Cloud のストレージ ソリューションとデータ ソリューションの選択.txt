サービスで使用するデータの特徴を文書化したので、ストレージとデータソリューションの選び方を確認しましょう
Google CloudのストレージとDBのポートフォリオは、リレーショナル、NoSQL、オブジェクト、DWH、インメモリストアを網羅しています
この表のとおりです
左から右に各サービスを見ていきましょう
Cloud SQLは固定スキーマのデータストアで、MySQL、PostgreSQL、SQL Serverを使用して提供されます
これらのサービスはCMSやeコマースなどのウェブアプリに適しています
Cloud Spannerも固定スキーマのRDBですが、無限にスケールしリージョンかマルチリージョンに設定できます
30GBを超えてスケール可能で、高可用性を備え、しかもグローバルにアクセス可能なRDBとしてサプライチェーン管理や製造などで使用されています
Google CloudのNoSQLデータストアはスキーマレスです
Firestoreはフルマネージドのドキュメントデータストアで、最大１MBのドキュメントに対応可能です
ゲームの状態情報やユーザープロファイルなどの階層データの保存に適しています
Cloud BigtableもNoSQLデータストアであり、無限にスケールします
大量の読み書きイベントや、金融サービス、IoT、デジタル広告、ストリームなどのユースケースに適しています
オブジェクトストレージとしてはCloud Storageがあります
Cloud Storageはスキーマレスのフルマネージド型で無限にスケールできます
バイナリオブジェクトデータを保存できるため、画像の保存、メディア配信、バックアップに適しています
データウェアハウジングには、BigQueryを使えます
このストレージは固定スキーマを使用し、保存データのSQL分析を完全に管理できます
分析やBIダッシュボードの作成を行う場合に理想的です
インメモリストレージのMemorystoreは、スキーマレスのマネージドRedis DBを提供します
ウェブ/モバイルアプリでのキャッシュ保存に適していて、マイクロサービスアーキテクチャでも状態へのアクセスを加速できます
これまで説明したサービスを決定チャートで要約しましょう
まず、データは構造化されていますか？
構造化データの形式でアクセスする必要がありますか？
その必要がない場合、共有ファイルシステムは必要ですか？
必要ならFilestore、不要ならCloud Storageを選びます
データが構造化されていて、この形式でアクセスする必要がある場合
ワークロードは分析中心ですか？
そうであれば、Cloud BigtableかBigQueryのいずれかをレイテンシと更新の要件に応じて選びます
そうでなければデータはリレーショナルですか？
リレーショナルでなければFirestoreを選び、リレーショナルであればCloud SQLまたはSpannerのいずれかを水平方向の拡張性の要件に応じて選びます
アプリによっては、このうちの複数のサービスを使用して処理を行う場合もあります
サービスの選択方法の詳細は、コースのリソースでストレージオプションとDBのリンクをご覧ください
Google Cloudへのデータの転送方法についても検討が必要です
検討すべき要素は、費用、時間、オフラインかオンラインでの転送、セキュリティなど多数あります
Cloud Storageへの転送は無料ですが、データの保存には料金が発生します
Transfer Applianceを使う場合は、その費用もかかります
別のプロバイダからの転送には、外向き料金が発生します
大量のデータセットがある場合、ネットワーク経由で転送するには非現実的な時間がかかります
仮に現実的だとしても、転送処理中は組織のインフラに大きな負荷がかかります
大規模なデータセットの移行に伴う課題がこの表でわかります
たとえば１TBのデータを100MB/秒の接続で転送するとしたら、完了には約12日かかります
色付きのセルは、非現実的な数字を示しているため、別のソリューションが必要となります
オンラインとオフラインの転送オプションを確認しましょう
少量のデータや時間指定のアップロードの場合、Cloud Storage Transfer Serviceを使うと、Storageバケットにデータを移動、バックアップできます
移動元はAmazon S3などの別のクラウドストレージプロバイダや、オンプレミスストレージ、HTTP/HTTPSロケーションなどです
Storageバケット間でもデータを移動して、他のユーザーグループやアプリで使えるようにできます
データ処理パイプラインや分析ワークフローの一環として、定期的にデータを移動することもできます
Storage Transfer Serviceには、転送や同期を容易にする方法が揃っています
たとえば、１回限りまたは定期的な転送処理をスケジュールできます
転送先バケット内の既存のオブジェクトを転送元に対応するものがない場合は削除したり、オブジェクトを転送後にデータソースから削除したりできます
データソースからデータシンクへの定期的な同期をスケジュールし、ファイル作成日に基づく高度なフィルタやファイル名フィルタ、データをインポートする日時を設定できます
Transfer Service for On Premises Dataは、データセンターからの大規模アップロード用です
このサービスを使用すると、オンプレミスストレージからCloud Storageに大量のデータをオンラインで転送できます
このサービスには、データ検証、暗号化、エラー時の再試行、フォールトトレランスが組み込まれています
オンプレミスSWはサーバーにインストールされ、エージェントはコンテナとして提供されてGoogle Cloudとの接続が設定されます
Cloud Storageに転送するディレクトリは、Cloud Consoleで選択できます
データ転送が開始されると多数のエージェントで転送処理が並列化されるため、数十億個のファイル、数百テラバイトまでスケールできます
Cloud Consoleで詳細な転送ログを確認できるほか、転送ジョブの作成、管理、モニタリングも行えます
このサービスを使用する際の要件は転送元がPOSIX準拠であること、300Mbps以上のネットワーク接続であることです
また、転送されるデータにアクセス可能なDocker対応Linuxサーバーも必要なほか、送信接続用にポート80と443を開いておく必要もあります
このサービスは１TBを超えるオンプレミスデータの転送に適しています
アップロードに時間がかかりすぎる大量のオンプレミスデータには、Transfer Applianceを使えます
Transfer Applianceはラックマウント型の大容量ストレージサーバーで、お客様のデータセンターに設置できます
そこにデータを格納したうえで、取り込み拠点に配送し、そこからGoogleにデータをアップします
データはお客様が管理する暗号鍵で保護され、転送完了後はGoogleがアプライアンスから消去します
Transfer Applianceを使用するには、まず配送をリクエストします
すると、不正開封防止シール付きの配送箱で届きます
アプライアンスにデータを転送したら、Googleに送り返します
データがCloud Storageに読み込まれると、データ利用可能の通知を受け取ります
Googleと取り込み拠点の間で受け渡される配送箱には不正開封防止シールが使われます
データはキャプチャした瞬間にAES256標準に従って暗号化されます
データ転送が完了すると、NIST 800-88標準に従ってアプライアンスからデータが消去されます
お客様が使用時にデータを復号します
BigQuery用の転送サービスもあります
BigQuery Data Transfer Serviceは、SaaSアプリからBigQueryへのデータの移動をスケジュール設定して自動化し、管理します
このサービスはGoogleアプリをソースとする転送をサポートしています
Google広告、キャンペーンマネージャー、YouTubeなどからの転送です
さまざまなデータコネクタもあり、Teradata、Amazon Redshift、Amazon S3からBigQueryに簡単にデータを転送できます
スライド上のスクリーンショットには転送のソースタイプの選択、スケジュールの構成、データ転送先の選択が示されています
データ形式も構成されています
